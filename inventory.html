<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
        crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <title>Inventory Management</title>
</head>

<body class="container">
    <!-- Your HTML content here -->

    <script>
        const baseUrl = 'https://crudcrud.com/api/8b96b7e04aa3474688fc9ca283e0fcef';
        const submitBtn = document.getElementById('submit_btn');
        submitBtn.addEventListener('click', enterDetails);

        async function enterDetails(event) {
            event.preventDefault();

            const itemName = document.getElementById('item_name').value;
            const itemDesc = document.getElementById('item_desc').value;
            const itemPrice = document.getElementById('item_price').value;
            const itemQuantity = document.getElementById('item_quantity').value;

            const add = {
                itemName: itemName,
                itemDesc: itemDesc,
                itemPrice: itemPrice,
                itemQuantity: itemQuantity
            };

            try {
                await axios.post(baseUrl, add);
                await displayDetails();
            } catch (err) {
                console.log(err);
            }

            document.getElementById('item_name').value = '';
            document.getElementById('item_desc').value = '';
            document.getElementById('item_price').value = '';
            document.getElementById('item_quantity').value = '';
        }

        async function displayDetails() {
            try {
                const response = await axios.get(baseUrl);
                const items = response.data;

                let output = "";

                for (let i = 0; i < items.length; i++) {
                    const add = items[i];
                    const key = add._id;

                    output += `
                    <div class="row">
                        <!-- Your display code here -->
                    </div>`;
                }

                document.getElementById("print").innerHTML = output;
            } catch (err) {
                console.log(err);
            }
        }

        async function buyItem(itemId, quantity) {
            try {
                const response = await axios.get(`${baseUrl}/${itemId}`);
                const item = response.data;

                if (item.itemQuantity >= quantity) {
                    const remainingQuantity = item.itemQuantity - quantity;
                    const patchQuantity = {
                        itemQuantity: remainingQuantity,
                    };

                    await axios.put(baseUrl + '/' + itemId, patchQuantity);
                    await displayDetails();
                    console.log(`Successfully`);
                } else {
                    console.log('Insufficient quantity available.');
                }
            } catch (err) {
                console.log(err);
            }
        }

        displayDetails();
    </script>
</body>

</html>
